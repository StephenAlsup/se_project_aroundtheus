!function(){"use strict";class e{constructor(e,t,s){let{name:n,link:o}=e;this._name=n,this._link=o,this._cardSelector=t,this._handlePreviewImage=s}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handlePreviewImage(this._name,this._link)}))}_handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}_handleLikeIcon(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement.querySelector(".card__image").src=this._link,this._cardElement.querySelector(".card__image").alt=this._name,this._cardElement.querySelector(".card__description").textContent=this._name,this._setEventListeners(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t,this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}toggleButtonState(){this._hasInvalidInput(this._inputEls)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this.toggleButtonState(),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValid(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}},s=class{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._popupElementCloseBtn=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}};class n extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t}_getInputValues(){const e=this._popupElement.querySelectorAll(".modal__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}close(){this._popupForm.reset(),super.close()}}class o{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const r={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_error",errorClass:"modal__error_visible"};const i=new class{constructor(e){let{baseUrl:t,authToken:s}=e;this._baseUrl=t,this._authToken=s}_checkResponse(e){return e.ok?e.json():Promise.reject("Error: ${res.status}")}getInitialCards(){return fetch("${this._baseUrl}/cards",{headers:{authorization:this._authToken}}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authToken}}).then(this._checkResponse)}editUserInfo(e){return console.log(e),fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:e.title,about:e.about})}).then(this._checkResponse)}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({avatar:e.avatar})}).then(this._checkResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._authToken,"Content-Type":"application/json"}}).then(this._checkResponse)}addCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:{authorization:this._authToken,"Content-Type":"application/json"}}).then(this._checkResponse)}removeCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:{authorization:this._authToken,"Content-Type":"application/json"}}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",authToken:"0b288917-ab08-48b1-b87e-440bc0c9842c"}),a=document.querySelector("#profile-edit-button"),l=document.querySelector("#profile-edit-modal").querySelector(".modal__form"),c=document.querySelector(".profile__title"),u=document.querySelector(".profile__subtitle"),d=document.querySelector("#profile-name-input"),h=document.querySelector("#profile-description-input"),_=document.querySelector(".profile__avatar-button"),m=document.querySelector(".profile__image"),p=document.querySelector(".profile__add-button"),E=document.querySelector("#add-card-modal").querySelector(".modal__form");function v(t){const s=new e(t,cardSelector,(()=>{I.open(t.name,t.link)}),(e=>{q.open(t),q.setAction((()=>{q.setButtonText(!0,"Deleting..."),i.deleteCard(e._id).then((()=>{console.log(e),e.deleteCard(),q.close()})).catch((e=>{console.error(e)})).finally((()=>{q.setButtonText(!1)}))}))}),(e=>{console.log(e._isLiked,e),e._isLiked?i.removeCardLike(e.getId()).then((()=>{e.setLikes(!1)})).catch((e=>{console.error(e)})):i.addCardLike(e.getId()).then((()=>{e.setLikes(!0)})).catch(console.error)}));k.addItem(s.getView())}const S=new class{constructor(e,t){this.name=e,this.description=t,this.avatar=avatar}getUserInfo(){return{name:this.name.textContent,description:this.description.textContent}}setUserInfo(e,t){console.log(this.name,this.description,e,t),this.name.textContent=e,this.description.textContent=t}setAvatar(e){this.avatar.src=e,this.avatar.alt=this.name.textContent}}(c,u,m),g=new n("#edit-avatar-modal",(e=>{g.setButtonText(!0),i.editUserPhoto(e).then((e=>{S.setAvatar(e.avatar),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.setButtonText(!1)}))})),b=avatarModal.querySelector(".modal__form");Promise.all([i.getUserInfo(),i.getInitialCards()]).then((e=>{let[t,s]=e;S.setUserInfo(t.name,t.about),S.setAvatar(t.avatar),console.log(s),k=new o({items:s,renderer:v},cardListSelector),k.renderItems()})).catch((e=>{console.error(e)})),a.addEventListener("click",(function(){!function(){const e=S.getUserInfo();d.value=e.name,h.value=e.description}(),w.open(),y.toggleButtonState()}));const k=new o({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=v(e);k.addItem(t)}},".cards__list");k.renderItems();const f=new n("#add-card-modal",(e=>(f.setButtonText(!0),i.addCard(e).then((e=>{console.log(e),v(e),f.close()})).catch((e=>{console.error(e)})).finally((()=>{f.setButtonText(!1)})))));f.setEventListeners();const y=new t(r,l),L=new t(r,E),C=new t(r,b);y.enableValidation(),L.enableValidation(),C.enableValidation();const w=new n("#profile-edit-modal",(function(e){S.setUserInfo(e.name,e.description),w.close()}));w.setEventListeners(),p.addEventListener("click",(()=>{f.open(),L.toggleButtonState()}));const I=new class extends s{constructor(e){super({popupSelector:e}),this._cardImage=this._popupElement.querySelector(".modal__image"),this._cardTitle=this._popupElement.querySelector(".modal__preview-title")}open(e,t){this._cardImage.src=t,this._cardImage.alt=e,this._cardTitle.textContent=e,super.open()}}("#preview-image");I.setEventListeners();const q=new class extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._handleFormSubmit=t}open(e){super.open(),this._cardData=e}close(){this._popupForm.reset(),super.close()}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}handleSubmit(e){e.preventDefault(),this._handleFormSubmit(this._cardData)}setEventListeners(){this._popupForm.addEventListener("submit",(e=>this.handleSubmit(e))),super.setEventListeners()}}("#delete-modal",(e=>{console.log("card",e)}));q.setEventListeners(),_.addEventListener("click",(()=>{C.toggleButtonState(),g.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TVosTUFDUixHSDhMd0Msa0JBQzFDaUYsRUFBZTNFLG9CQU1mLE1BQU02RSxFQUFrQixJSWxOeEIsY0FBb0N6RSxFQUNsQzFFLFdBQUFBLENBQVk2RCxFQUFlYyxHQUN6QkMsTUFBTSxDQUFFZixrQkFDUnZELEtBQUt1RSxXQUFhdkUsS0FBS3dELGNBQWNqRCxjQUFjLGdCQUNuRFAsS0FBS29DLGNBQWdCcEMsS0FBS3dELGNBQWNqRCxjQUFjLGtCQUN0RFAsS0FBS2dMLGtCQUFvQmhMLEtBQUtvQyxjQUFjaEIsWUFDNUNwQixLQUFLd0Usa0JBQW9CSCxDQUMzQixDQUVBWCxJQUFBQSxDQUFLK0UsR0FDSG5FLE1BQU1aLE9BQ04xRCxLQUFLaUwsVUFBWXhDLENBQ25CLENBRUE3RSxLQUFBQSxHQUNFNUQsS0FBS3VFLFdBQVdPLFFBQ2hCUixNQUFNVixPQUNSLENBRUFtRixhQUFBQSxDQUFjbUMsR0FBa0MsSUFBMUJDLEVBQVVDLFVBQUFDLE9BQUEsUUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUcsWUFFL0JwTCxLQUFLb0MsY0FBY2hCLFlBRGpCOEosRUFDK0JDLEVBRUFuTCxLQUFLZ0wsaUJBRTFDLENBRUFPLFlBQUFBLENBQWFDLEdBQ1hBLEVBQU1sSSxpQkFDTnRELEtBQUt3RSxrQkFBa0J4RSxLQUFLaUwsVUFDOUIsQ0FFQWpILGlCQUFBQSxHQUNFaEUsS0FBS3VFLFdBQVcvRCxpQkFBaUIsVUFBV2dMLEdBQzFDeEwsS0FBS3VMLGFBQWFDLEtBRXBCbEgsTUFBTU4sbUJBQ1IsR0o2S2dELGlCQUFrQjRFLElBQ2xFN0IsUUFBUUMsSUFBSSxPQUFRNEIsRUFBSyxJQUUzQkMsRUFBZ0I3RSxvQkFFaEJvRSxFQUFhNUgsaUJBQWlCLFNBQVMsS0FDckNvSyxFQUFvQjNILG9CQUNwQjRHLEVBQWlCbkcsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsLCBoYW5kbGVFc2NhcGUgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCBjYXJkU2VsZWN0b3IsIGhhbmRsZVByZXZpZXdJbWFnZSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZVByZXZpZXdJbWFnZSA9IGhhbmRsZVByZXZpZXdJbWFnZTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVQcmV2aWV3SW1hZ2UodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Rlc2NyaXB0aW9uXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsKSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsID0gZm9ybUVsO1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWQoaW5wdXRFbCkge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxzLnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVscykpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkKGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRDbG9zZUJ0biA9XHJcbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICAvL3RoaXMuX3BvcHVwQ2xvc2VGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgLy90aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsX19pbnB1dCcpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgY29uc3QgZGF0YSA9IHt9O1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGRhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xyXG4gIHByb2ZpbGVDbG9zZUJ0bjogXCIjcHJvZmlsZS1jbG9zZS1idXR0b25cIixcclxuICB1c2VySW5mb1Byb2ZpbGVUaXRsZTogXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIsXHJcbiAgdXNlckluZm9Qcm9maWxlRGVzY3JpcHRpb25JbnB1dDogXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiLFxyXG4gIGNhcmRMaXN0RWw6IFwiLmNhcmRzX19saXN0XCIsXHJcbiAgY2FyZFRlbXBsYXRlOiBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgY2FyZENsb3NlQnRuOiBcIiNjYXJkLW1vZGFsLWNsb3NlXCIsXHJcbiAgY2FyZEFkZExpbms6IFwiI2NhcmQtdXJsLWlucHV0XCIsXHJcbiAgY2FyZEFkZFRpdGxlOiBcIiNjYXJkLXRpdGxlLWlucHV0XCIsXHJcbiAgY2FyZEFkZFRpdGxlSW5wdXQ6IFwiI2NhcmQtdGl0bGUtaW5wdXRcIixcclxuICBjYXJkQWRkTGlua0lucHV0OiBcIiNjYXJkLXVybC1pbnB1dFwiLFxyXG4gIHByZXZpZXdJbWFnZU1vZGFsOiBcIiNwcmV2aWV3LWltYWdlXCIsXHJcbiAgcHJldmlld0Nsb3NlQnRuOiBcIiNwcmV2aWV3LWltYWdlLWNsb3NlXCIsXHJcbiAgY2FyZFNlbGVjdG9yOiBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IGluaXRpYWxDYXJkcywgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBhdXRoVG9rZW46IFwiMGIyODg5MTctYWIwOC00OGIxLWI4N2UtNDQwYmMwYzk4NDJjXCIsXHJcbn0pO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZVN1YnRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19zdWJ0aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5cclxuY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xyXG5jb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcblxyXG5jb25zdCBjYXJkQWRkRm9ybSA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBwb3B1cFdpdGhJbWFnZS5vcGVuKGNhcmREYXRhLm5hbWUsIGNhcmREYXRhLmxpbmspO1xyXG4gICAgfSxcclxuICAgIChjYXJkKSA9PiB7XHJcbiAgICAgIGRlbGV0ZUNhcmRNb2RhbC5vcGVuKGNhcmREYXRhKTtcclxuICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNldEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNldEJ1dHRvblRleHQodHJ1ZSwgXCJEZWxldGluZy4uLlwiKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmQuX2lkKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjYXJkKTtcclxuICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5zZXRCdXR0b25UZXh0KGZhbHNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAoY2FyZCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhjYXJkLl9pc0xpa2VkLCBjYXJkKTtcclxuICAgICAgaWYgKGNhcmQuX2lzTGlrZWQpIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5yZW1vdmVDYXJkTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuc2V0TGlrZXMoZmFsc2UpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmFkZENhcmRMaWtlKGNhcmQuZ2V0SWQoKSlcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5zZXRMaWtlcyh0cnVlKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZC5nZXRWaWV3KCkpO1xyXG59XHJcbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5uYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuZGVzY3JpcHRpb247XHJcbn1cclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVUaXRsZSwgcHJvZmlsZVN1YnRpdGxlLCBhdmF0YXJJbWFnZSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChmb3JtRGF0YSkge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKGZvcm1EYXRhLm5hbWUsIGZvcm1EYXRhLmRlc2NyaXB0aW9uKTtcclxuICBwcm9maWxlRm9ybS5jbG9zZSgpO1xyXG59XHJcblxyXG5jb25zdCBhdmF0YXJNb2RhbFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjZWRpdC1hdmF0YXItbW9kYWxcIixcclxuICAoYXZhdGFySW5mbykgPT4ge1xyXG4gICAgYXZhdGFyTW9kYWxQb3B1cC5zZXRCdXR0b25UZXh0KHRydWUpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlclBob3RvKGF2YXRhckluZm8pXHJcbiAgICAgIC50aGVuKChpbmZvKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0QXZhdGFyKGluZm8uYXZhdGFyKTtcclxuICAgICAgICBhdmF0YXJNb2RhbFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgYXZhdGFyTW9kYWxQb3B1cC5zZXRCdXR0b25UZXh0KGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4pO1xyXG5cclxuY29uc3QgYXZhdGFyTW9kYWxFbCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XHJcbiAgICB1c2VySW5mby5zZXRBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICAgIGNvbnNvbGUubG9nKGNhcmRzKTtcclxuICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBpdGVtczogY2FyZHMsXHJcbiAgICAgICAgcmVuZGVyZXI6IGNyZWF0ZUNhcmQsXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRMaXN0U2VsZWN0b3JcclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICB9KTtcclxuXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0Q2xpY2soKSB7XHJcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XHJcbiAgcHJvZmlsZUZvcm0ub3BlbigpO1xyXG4gIGVkaXRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbn1cclxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRDbGljayk7XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZCk7XHJcbn07XHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcclxuICB9LFxyXG4gIFwiLmNhcmRzX19saXN0XCJcclxuKTtcclxuXHJcbmNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2FkZC1jYXJkLW1vZGFsXCIsIChjYXJkRGF0YSkgPT4ge1xyXG4gIGFkZENhcmRGb3JtLnNldEJ1dHRvblRleHQodHJ1ZSk7XHJcbiAgcmV0dXJuIGFwaVxyXG4gICAgLmFkZENhcmQoY2FyZERhdGEpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgIGNyZWF0ZUNhcmQocmVzKTtcclxuICAgICAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYWRkQ2FyZEZvcm0uc2V0QnV0dG9uVGV4dChmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcbmFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwcm9maWxlRWRpdEZvcm0pO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGNhcmRBZGRGb3JtKTtcclxuY29uc3QgZWRpdEF2YXRhclZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhdmF0YXJNb2RhbEVsKTtcclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuZWRpdEF2YXRhclZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkQWRkRm9ybVN1Ym1pdCh7IHRpdGxlLCB1cmwgfSkge1xyXG4gIGNvbnN0IGNhcmREYXRhID0ge1xyXG4gICAgbmFtZTogdGl0bGUsXHJcbiAgICBsaW5rOiB1cmwsXHJcbiAgfTtcclxuICByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxufVxyXG5cclxuY29uc3QgcHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxyXG4pO1xyXG5cclxucHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkRm9ybS5vcGVuKCk7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2VcIik7XHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2Z1bmN0aW9uIGhhbmRsZVByZXZpZXdJbWFnZShuYW1lLCBsaW5rKSB7XHJcbiAgLy9wb3B1cFdpdGhJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG4vL31cclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjZGVsZXRlLW1vZGFsXCIsIChjYXJkKSA9PiB7XHJcbiAgY29uc29sZS5sb2coXCJjYXJkXCIsIGNhcmQpO1xyXG59KTtcclxuZGVsZXRlQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0QXZhdGFyVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgYXZhdGFyTW9kYWxQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBhdXRoVG9rZW4gfSkge1xyXG4gICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgICAgdGhpcy5fYXV0aFRva2VuID0gYXV0aFRva2VuO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgICAgIGlmKHJlcy5vaykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ0Vycm9yOiAke3Jlcy5zdGF0dXN9Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goJyR7dGhpcy5fYmFzZVVybH0vY2FyZHMnLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlbixcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG4gZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICB9XHJcbiBcclxuICAgIGVkaXRVc2VySW5mbyhpbmZvKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coaW5mbyk7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlbixcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBuYW1lOiBpbmZvLnRpdGxlLFxyXG4gICAgICAgICAgICBhYm91dDogaW5mby5hYm91dCxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbmVkaXRVc2VyQXZhdGFyKGluZm8pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICBhdmF0YXI6IGluZm8uYXZhdGFyLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuYWRkQ2FyZChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4sXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgIH1cclxuICAgIGFkZENhcmRMaWtlKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlbixcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICByZW1vdmVDYXJkTGlrZShjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4sXHJcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5hdmF0YXIgPSBhdmF0YXI7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMubmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuZGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMubmFtZSwgdGhpcy5kZXNjcmlwdGlvbiwgbmFtZSwgZGVzY3JpcHRpb24pO1xyXG5cclxuICAgIHRoaXMubmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLmF2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgICB0aGlzLmF2YXRhci5hbHQgPSB0aGlzLm5hbWUudGV4dENvbnRlbnQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctdGl0bGVcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIG9wZW4oY2FyZERhdGEpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2NhcmREYXRhID0gY2FyZERhdGE7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0LCBidXR0b25UZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKHN1Ym1pdCkge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBidXR0b25UZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGhhbmRsZVN1Ym1pdChldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fY2FyZERhdGEpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+XHJcbiAgICAgIHRoaXMuaGFuZGxlU3VibWl0KGV2ZW50KVxyXG4gICAgKTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhDb25maXJtYXRpb247XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlUHJldmlld0ltYWdlIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlUHJldmlld0ltYWdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUljb24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsInJlbW92ZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImdldFZpZXciLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsInNldHRpbmdzIiwiZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbCIsIl9pbnB1dEVscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVkIiwiZm9yRWFjaCIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9wb3B1cEVsZW1lbnRDbG9zZUJ0biIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRMaXN0IiwiZGF0YSIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiZm9ybVNlbGVjdG9yIiwiYXBpIiwiYmFzZVVybCIsImF1dGhUb2tlbiIsIl9iYXNlVXJsIiwiX2F1dGhUb2tlbiIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ0aGVuIiwiZ2V0VXNlckluZm8iLCJlZGl0VXNlckluZm8iLCJpbmZvIiwiY29uc29sZSIsImxvZyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidGl0bGUiLCJhYm91dCIsImVkaXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiYWRkQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRDYXJkTGlrZSIsInJlbW92ZUNhcmRMaWtlIiwicHJvZmlsZUVkaXRCdG4iLCJwcm9maWxlRWRpdEZvcm0iLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlU3VidGl0bGUiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiYXZhdGFyQnV0dG9uIiwiYXZhdGFySW1hZ2UiLCJhZGRDYXJkQnV0dG9uIiwiY2FyZEFkZEZvcm0iLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJuZXdDYXJkIiwicG9wdXBXaXRoSW1hZ2UiLCJjYXJkIiwiZGVsZXRlQ2FyZE1vZGFsIiwic2V0QWN0aW9uIiwic2V0QnV0dG9uVGV4dCIsIl9pZCIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJmaW5hbGx5IiwiX2lzTGlrZWQiLCJnZXRJZCIsInNldExpa2VzIiwiY2FyZFNlY3Rpb24iLCJ1c2VySW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXIiLCJhdmF0YXJNb2RhbFBvcHVwIiwiYXZhdGFySW5mbyIsImVkaXRVc2VyUGhvdG8iLCJhdmF0YXJNb2RhbEVsIiwiYXZhdGFyTW9kYWwiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwiY2FyZExpc3RTZWxlY3RvciIsImZpbGxQcm9maWxlRm9ybSIsInByb2ZpbGVGb3JtIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybSIsIkZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiZWRpdEF2YXRhclZhbGlkYXRvciIsImZvcm1EYXRhIiwiX2NhcmRJbWFnZSIsIl9jYXJkVGl0bGUiLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9jYXJkRGF0YSIsInN1Ym1pdCIsImJ1dHRvblRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJoYW5kbGVTdWJtaXQiLCJldmVudCJdLCJzb3VyY2VSb290IjoiIn0=